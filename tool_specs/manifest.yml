version: 1
updated: 2024-11-26
tools:
  - name: github_mcp
    display_name: "GitHub MCP Telemetry"
    spec_file: github_mcp.md
    description: >-
      Guidance for orchestrating the GitHub MCP server to gather delivery, risk,
      and roadmap telemetry (merged PRs, releases, blockers, project items) for PMAgent specs.
    servers:
      - id: github
        recommended_url: https://api.githubcopilot.com/mcp/
        alternatives:
          - type: stdio
            command: go run ./cmd/github-mcp-server stdio --dynamic-toolsets
            env:
              GITHUB_PERSONAL_ACCESS_TOKEN: "${input:github_token}"
    required_toolsets: [repos, issues, pull_requests, projects]
    discovery_tools: [list_available_toolsets, get_toolset_tools, enable_toolset]
    capabilities:
      - id: merged_prs_last_week
        description: Fetch merged pull requests from the previous week with owners, reviewers, labels, and merge timestamps.
        recommended_calls:
          - tool: list_pull_requests
            arguments:
              owner: "<org>"
              repo: "<repo>"
              state: closed
              sort: updated
              direction: desc
              perPage: 50
            post_process: Filter to records with non-null merged_at inside the last 7 days and bucket by spec sub-area.
          - tool: search_pull_requests
            arguments:
              query: "repo:<org>/<repo> is:pr is:merged merged:>=<yyyy-mm-dd>"
      - id: recent_releases_or_tags
        description: Identify releases/tags published during the reporting window.
        recommended_calls:
          - tool: list_releases
            arguments:
              owner: "<org>"
              repo: "<repo>"
              perPage: 20
      - id: open_blocker_issues
        description: Retrieve Sev0/Sev1/blocker issues or PRs with owners + mitigations.
        recommended_calls:
          - tool: search_issues
            arguments:
              query: "org:<org> (label:blocker OR label:risk OR label:\"Sev0\") is:open updated:>=<yyyy-mm-dd>"
      - id: failing_work_items
        description: Surface PRs with failing workflows or pending reviews for risk tracking.
        recommended_calls:
          - tool: pull_request_read
            arguments:
              method: get_status
              owner: "<org>"
              repo: "<repo>"
              pullNumber: "<number>"
      - id: project_items_upcoming
        description: Pull project board items or milestones categorized as Upcoming/Ready with due dates.
        recommended_calls:
          - tool: list_project_items
            arguments:
              org: "<org>"
              project_number: "<project #>"
              query: "status:Upcoming"
          - tool: list_milestones
            arguments:
              owner: "<org>"
              repo: "<repo>"
              state: open
    fallback:
      triggers: [github_server_missing, tool_not_available, empty_or_insufficient_results]
      steps:
        - action: ask_user
          prompt: "Share the top merged PRs (title + link + owner) for each sub-area last week."
        - action: ask_user
          prompt: "List any Sev0/Sev1 or blocker issues plus mitigations."
        - action: ask_user
          prompt: "Provide upcoming launches or milestones with target dates for the next two weeks."
        - action: document_gap
          note: "State in the final output that GitHub telemetry was unavailable and data is manual."
    example_sequences:
      - name: github_weekly_rollup
        description: Discover GitHub MCP capabilities and retrieve telemetry for weekly PM updates.
        steps:
          - order: 1
            tool: mcp.list_tools
            purpose: Confirm the `github` server is registered in the host session.
          - order: 2
            tool: github.list_available_toolsets
            purpose: Inspect enabled toolsets.
          - order: 3
            tool: github.enable_toolset
            purpose: Enable missing toolsets when dynamic discovery is active.
            arguments:
              toolset: pull_requests
          - order: 4
            tool: github.list_pull_requests
            purpose: Fetch merged PRs for the target repo(s).
            arguments:
              owner: "azure"
              repo: "pmagent-spec"
              state: closed
              sort: updated
              direction: desc
              perPage: 30
          - order: 5
            tool: github.search_issues
            purpose: Find open blockers labeled `risk`.
            arguments:
              query: "repo:azure/pmagent-spec label:risk is:issue is:open updated:>=2024-11-18"
          - order: 6
            tool: github.list_project_items
            purpose: Pull upcoming roadmap items from the shared project board.
            arguments:
              org: "azure"
              project_number: 42
              query: "status:Upcoming"
    specs_referencing: [monday_minutes]
